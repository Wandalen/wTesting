# Тест перевірка

Тест перевірка - очікування розробника стосовно поведінки об'єкту, що тестується виражене якоюсь умовою. Це найнижча структурна одиниця тестування.

Більшість перевірок приймаю два аргументи і порівнюючи їх видають позитивний або негативний результат тестування:

- отримані дані
- очікувані дані

[Тест кейс](TestCase.md) складається із одної або декількох перевірок. Достатньо лише однієї перевірки із результатом `failed` щоб увесь об'єкт, що тестується вважався таким, що не пройшов тестування.

### Приклад тест кейса з перевірками

![test.check](../../images/test.check.png)

На рисунку зображено тест кейс `join strings` з трьома тест перевірками. Кожна з перевірок порівнює два значення. Перше отримане з допомогою методу `join`, а друге, очікуване значення, задане розробником.

## Позитивне тестування

Тестування коректності роботи об'єкта тестування за нормальних умов, при відсутності помилок в вхідних даних та нормальному стані.

Для позитивного тестування можуть застосовуватись такі перевірки:
- `true`;
- `false`;
- `identical`;
- `notIdentical`;
- `equivalent`;
- `notEquivalent`;
- `contains`;
- `gt`;
- `ge`;
- `lt`;
- `le`;
- `mustNotThrowError`;
- `shouldReturnSingleResource`.

## Негативне тестування

Тестування коректності обробки об'єктом тестування помилкових даних чи помилкового стану.

Для негативного тестування застосовуються такі перевірки:
- `shouldThrowErrorSync`;
- `shouldThrowErrorAsync`;
- `shouldThrowErrorOfAnyKind`.

### Перелік перевірок

##### Тест перевірка `true`

Очікує єдиний аргумент типу `bool-like`.

Перевірка проходиться, якщо аргумент `true-like`, тобто, `true` або числове значення відмінне від нуля.

Перевірка провалюється, якщо аргумент `false-like`, тобто, `false` чи числове значення `0`.

Повертає `true`, якщо перевірку пройдено та `false`, якщо перевірка провалилася.

```js
var got = true;
test.true( got );
```

Перевірку `test.true` буде пройдено так, як в момент перевірки змінна `got` має значення `true`.

##### Тест перевірка `false`

Очікує єдиний аргумент типу `bool-like`.

Перевірка проходиться, якщо аргумент `false-like`, тобто, `false` або числове значення рівне нулю.

Перевірка провалюється, якщо аргумент `true-like`, тобто, `true` або числове значення відмінне від нуля.

```js
var got = false;
test.false( got );
```

Перевірку `test.false` буде пройдено так, як в момент перевірки змінна `got` має значення `false`.

##### Тест перевірка `identical`

Крім повної форми, має скорочену - `il`.

Очікує два аргументи будь-яких типів.

Перевірка проходиться, якщо передані аргументи повністю ідентичні.

Перевірка провалюється, якщо значення аргументів відрізняються. Числова похибка не допускається.

```js
var got = { a : 'ok' };
var expected = { a : 'ok' };
test.identical( got, expected );
```

Перевірку `test.identical` буде пройдено так, як в момент перевірки значення обох аргументів ідентичні.

##### Тест перевірка `notIdentical`

Крім повної форми, має скорочену - `ni`.

Очікує два аргументи будь-яких типів.

Перевірка проходиться, якщо передані аргументи не співпадають.

Перевірка провалюється, якщо аргументи повністю ідентичні. Числова похибка не допускається.

```js
var got = { a : 'ok' };
var expected = { a : 'ok' };
test.notIdentical( got, expected );
```

Перевірку `test.notIdentical` буде провалено так, як в момент перевірки значення обох аргументів ідентичні.

```js
var got = 1;
var expected = 1 + 1e-10;
test.notIdentical( got, expected );
```

Перевірку `test.notIdentical` буде пройдено так, як в перше значення відрізняється від другого на `1e-10`.

##### Тест перевірка `equivalent`

Крім повної форми, має скорочену - `et`.

Очікує два аргументи будь-яких типів.

Перевірка проходиться, якщо значення переданих аргументів схожі.

Перевірка провалюється, якщо значення аргументів не схожі достатньо. Допускається числова похибка `eps`, яка задається через опції тестування. Допустима числова похибка за замовчуванням `1e-7`.

```js
var got = 1;
var expected = 1.00001;
test.equivalent( got, expected );
```

Перевірку `test.equivalent` буде провалено так, як значення похибки за замовчуванням `1е-7`, а значення відрізняється на `1е-5`.

```js
function somer( test )
{
  var got = 1;
  var expected = 1.00001;
  test.equivalent( got, expected );
}
somer.accuracy = 1e-4
```
Перевірку `test.equivalent` буде пройдено так, як значення похибки в тест рутині `somer` встановлено в `1е-4`.

```js
var got = true;
var expected = 1;
test.et( got, expected );
```

Перевірку `test.et` буде пройдено так, як значення `got` і значення `expected` схожі.

| got і expected| equivalent | identical |
|:----------------------------------|:-----------------------|:----------------------|
|  true, 1                          | pass                   | failed                |
|  false, 0                         | pass                   | failed                |
|  1, 1 + 1e-7                      | pass                   | failed                |
|  1, 1 - 1e-7                      | pass                   | failed                |

Таблиця демонструє відмінності між перевірками `equivalent` та `identical`.

##### Тест перевірка `notEquivalent`

Крім повної форми, має скорочену - `ne`.

Очікує два аргументи будь-яких типів.

Перевірка проходиться, якщо значення переданих аргументів відрізняються достатньо.

Перевірка провалюється, якщо значення аргументів занадто схожі. Допускається числова похибка `eps`, яка задається через опції тестування. Допустима числова похибка за замовчуванням `1e-7`.

```js
var got = 1;
var expected = 1.00001;
test.ne( got, expected );
```

Перевірку `test.ne` буде пройдено так, як значення похибки за замовчуванням `1е-7` і очікуване значення відрізняється від отриманого на `1е-5`.

| `got` і `expected`| `notEquivalent` | `notIdentical` |
|:--------------------------------------|:----------------------------|:---------------------------|
|  true, 1                              | failed                      | pass                       |
|  false, 0                             | failed                      | pass                       |
|  1, 1 + 1e-7                          | failed                      | pass                       |
|  1, 1 - 1e-7                          | failed                      | pass                       |

Таблиця демонструє відмінності між перевірками `notEquivalent` та `notIdentical`.

##### Тест перевірка `contains`

Очікує два аргументи будь-яких типів.

Перевірка проходиться, якщо передані аргументи ідентичні або перший аргумент містить в собі другий аргумент. У випадку, якщо порівнюються асоціативні масиви то перший має містить пари ключ-значення другого. Числова похибка не допускається.

Перевірка провалюється, якщо перший аргумент не повністю міститься в другому.

```js
var got = 13;
var expected = 13;
test.contains( got, expected );
```

Перевірку `test.contains` буде пройдено так, як значення `got` і значення `expected` співпадають.

```js
var got = { a : 1, b : 2, c : 3 };
var expected = { a : 1 };
test.contains( got, expected );
```

Перевірку `test.contains` буде пройдено так, як в асоціативному масиві `got` є елемент `a:1`.

```js
var got = { a : 1, b : 2, c : 3 };
var expected = { d : 4 };
test.contains( got, expected );
```

Перевірку `test.contains` буде провалено так, як в асоціативному масиві `got` не має елемента `d : 4`.

```js
var got = { a : 1, b : 2, c : 3 };
var expected = { a : 4 };
test.contains( got, expected );
```

Перевірку `test.contains` буде провалено так, як в асоціативному масиві `got` не має елемента `a : 4`.

##### Тест перевірка `gt`

Очікує два аргументи числового типу або типу, який можна привести до такого. При необхідності здійснюється приведення ( coercing ) до числового типу.

Перевірка проходиться, якщо значення першого аргумента більше значення другого.

Перевірка провалюється, якщо значення першого аргумента менше або рівне значенню другому.

```js
var a = true;
var b = 0;
test.gt( a, b )
```

Перевірку `test.gt` буде пройдено так, як значення змінної `a` буде приведено до `1`, що більше `0`.

##### Тест перевірка `ge`

Очікує два аргументи числового типу або типу, який можна привести до такого. При необхідності здійснюється приведення ( coercing ) до числового типу.

Перевірка проходиться, якщо значення першого аргумента більше або рівне значенню другого.

Перевірка провалюється, якщо значення першого аргумента менше значення другому.

```js
var a = true;
var b = 1;
test.ge( a, b )
```

Перевірку `test.ge` буде пройдено так, як значення змінної `a` буде приведено до `1`, і значення обох аргументів рівні.

##### Тест перевірка `lt`

Очікує два аргументи числового типу або типу, який можна привести до такого. При необхідності здійснюється приведення ( coercing ) до числового типу.

Перевірка проходиться, якщо значення першого аргумента менше другого.

Перевірка провалюється, якщо значення першого аргумента більше або рівне другому.

```js
var a = false;
var b = 1;
test.lt( a, b )
```

Перевірку `test.lt` буде пройдено так, як значення змінної `a` буде приведено до `0`, що більше `1`.

##### Тест перевірка `le`

Очікує два аргументи числового типу або типу, який можна привести до такого. При необхідності здійснюється приведення ( coercing ) до числового типу.

Перевірка проходиться, якщо значення першого аргумента менше або рівне значенню другого.

Перевірка провалюється, якщо значення першого аргумента більше значення другого.

```js
var a = false;
var b = 0;
test.le( a, b )
```

Перевірку `test.le` буде пройдено так, як значення змінної `a` буде приведено до `0`, що рівно значенню `b`.

##### Тест перевірка `shouldThrowErrorSync`

Очікує один аргумент у вигляді рутини, котру буде запущено без аргументів для перевірки її роботи.

Перевірка проходиться, якщо рутина викидає помилку. Асинхронні помилки тест перевірка `shouldThrowErrorSync` не помічає.

Перевірка провалюється, якщо рутина не викидує помилку.

```js
test.shouldThrowErrorOfAnyKind( function()
{
  throw 'err1';
});
```

Перевірку `test.shouldThrowErrorSync` буде пройдено так, як указана рутина викидає помилку при її виконанні.

##### Тест перевірка `shouldThrowErrorAsync`

Очікує один аргумент у вигляді рутини, котру буде запущено без аргументів для перевірки її роботи.

Перевірка проходиться, якщо рутина викидає помилку в асинхронному режимі, тобто, через `наслідок` або `промайс`. Асинхронні помилки можуть бути відстрочені по часу від моменту повернення із рутини.

Перевірка провалюється, якщо рутина не викидує помилку за час відведений на її тестуання.

```js
test.shouldThrowErrorAsync( function()
{
  return _.timeOut( 250, function()
  {
    throw _.err( 'test' );
  });
});
```

Перевірку `test.shouldThrowErrorAsync` буде пройдено так, як указана рутина викидає асинхронно помилку. Рутина `timeOut` повертає наслідок із помилкою `_.err( 'test' )`.

##### Тест перевірка `shouldThrowErrorOfAnyKind`

Очікує один аргумент у вигляді рутини, котру буде запущено без аргументів для перевірки її роботи.

Перевірка проходиться, якщо рутина викидає помилку в синхронно або асинхронному, тобто, через `наслідок` або `промайс`. Асинхронні помилки можуть бути відстрочені по часу від моменту повернення із рутини.

Перевірка провалюється, якщо рутина не викидує ані синхронну, ані асинхронну помилку за час відведений на її тестуання.

```js
test.shouldThrowErrorOfAnyKind( function r1()
{
  throw 'err1';
});
```

Перевірку `test.shouldThrowErrorOfAnyKind` буде пройдено так, як рутина `r1` викидає помилку `throw 'err1'` синхронно.

```js
test.shouldThrowErrorOfAnyKind( function r2()
{
  return _.timeOut( 250, function()
  {
    throw _.err( 'test' );
  });
});
```

Перевірку `test.shouldThrowErrorOfAnyKind` буде пройдено так, як рутина `r2` викидає помилку `throw _.err( 'test' )` асинхронно, через `250мс` після її запуску.

##### Тест перевірка `mustNotThrowError`

Очікує один аргумент у вигляді рутини, котру буде запущено без аргументів для перевірки її роботи.

Перевірка проходиться, якщо рутина не викидає помилку ні синхронному, ні асинхронному режимі.

Перевірка провалюється, якщо рутина викидує помилку синхронно або асинхронно. Тестова рутина може продовжити своє виконання після такої помилки так, як її буде ізольовано в підрутині.

```js
test.shouldThrowErrorOfAnyKind( function r1()
{
  return 'value';
});
```

Перевірку `test.mustNotThrowError` буде пройдено так, як синхронна рутина `r1` не викидає помилку.

```js
test.shouldThrowErrorOfAnyKind( function r1()
{
  return _.timeOut( 250, function()
  {
    return 'value`;
  });
});
```

Перевірку `test.mustNotThrowError` буде пройдено так, як асинхронна рутина `r2` не викидає помилку.

##### Тест перевірка `shouldReturnSingleResource`

Очікує один аргумент у вигляді рутини, котру буде запущено без аргументів для перевірки її роботи.

Перевірка проходиться, якщо рутина завершується синхронно або наслідком повертається лише одне повідомлення.

Перевірка провалюється, якщо її наслідок отримує декілька повідомлень.

```js
test.shouldReturnSingleResource( function r()
{
  var con = new _.Consequence();
  con.take( 1 );
  con.take( 2 );
  return con;
});
```

Перевірка `test.shouldReturnSingleResource` буде провалено так як рутина `r` повертає наслідок із двома повідомленнями `1` та `2`.

[Повернутись до змісту](../README.md#Концепції)

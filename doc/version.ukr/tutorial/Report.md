## Як читати звіт та групувати перевірки

Як читати звіт тестування та групувати тест перевірки в групи та тест кейси. Як опис відображається в звіті.

### Об'єкт тестування

<details>
    <summary><u>Код файла <code>Join.js</code></u></summary>

```js
module.exports.join = function( a, b )
{
  return String( a ) + String( b );
}
```

</details>

Внесіть приведений вище код в файл `Join.js`.

Функція `join` виконує конкатенацію двох рядків. Вона експортується для використання.

### Тестовий файл

Тест сюіт `Join.test.js` має суфікс `.test` для того, щоб утиліта для тестування могла знайти його.

<details>
    <summary><u>Код файла <code>Join.test.js</code></u></summary>

```js
let _ = require( 'wTesting' );
let Join = require( './Join.js' );

//

function routine1( test )
{
  test.open( 'string' );

    test.case = 'trivial';
    test.identical( Join.join( 'a', 'b' ), 'ab' );

    test.case = 'empty';
    test.identical( Join.join( '', '' ), '' );

  test.close( 'string' );
  test.open( 'number' );

    test.case = 'trivial';
    test.identical( Join.join( 1, 3 ), '13' );

    test.case = 'zeroes';
    test.identical( Join.join( 0, 0 ), '00' );

  test.close( 'number' );
  test.open( 'mixed' );

    test.identical( Join.join( 'a', 1 ), 'a1' );

  test.close( 'mixed' );
}

//

let Self =
{
  name : 'Join',
  tests :
  {
    routine1,
  }
}

//

Self = wTestSuite( Self );
if( typeof module !== 'undefined' && !module.parent )
wTester.test( Self.name );
```

</details>

Внесіть приведений вище код в файл `Join.test.js`.

Тестова рутина `routine1` має 2-ві групи перевірок `string` та `number`, а також тест кейс `mixed` з однією перевіркою. Група `string` містить 2-ва тест кейсa `trivial` та `empty`, в кожному із яких по одній перевірці. Група `number` має тест кейси `trivial` та `zeroes` із одною перевіркою в кожному.  Групи були сформовані по типу аргументів, що передаються функції `Join.join`, яка тестується. В перевірках групи `string` використовуються рядкові значення, в `number` - числові, в тест кейсі `mixed` - рядкові з числовими.

### Як читати звіт про тестування

Між структурою тест файла і виводом результатів тестування є пряма залежність.

Встановіть залежність `Testing` та запустіть тестування в файлі `Join.test.js`, виконавши команду

```
tst .imply verbosity:5 .run Join.test.js
```

Опцією `verbosity` встановлено кількість виводу інформації. Детальніше про опцію можете дізнатись в туторіалі про [контроль рівня вербальності](Verbosity.md).

##### Відповідність між звітом в консолі і вмістом файла `Join.test.js`

![report.png](../../images/report.png)

На рисунку зліва приведений вивід консолі отриманий після виконання команди. Він ділиться на чотири основні секції та містить декілька додаткових сервісних повідомлень.

Перша секція - опції тестування. Призначена для виводу поточних параметрів тестування. В четвертому рядку знизу секції можете знайти опцію `verbosity` зі значенням `5`, це значення було встановлено в опції введеної команди.

Друга секція - вивід звіту тестування по окремим тест рутинам. При тестуванні скопом така секція є у кожного тест сюіту.

Кількість тест рутин, тест кейсів та тест перевірок визначається кодом тест сюіта. На рисунку справа приведений код файла `Join.test.js`. В звіт потрапили результати виконання п'яти тест кейсів в рутині `routine1`. З указаних тест кейсів створено дві групи - `string` i `number`. Для того, щоб об'єднати тест кейси в групу використовуються рутини [`open()` i `close()`](../concept/TestCase.md).

Рядок зі звітом проходження тест кейса при використанні вкладення виглядає:

```
Test check ( Join / routine1 / string > trivial # 1) ... ok

```

Цей запис свідчить, що тест перевірка пройдена, вона має номер 1. В дужках позначено шлях, за яким знаходиться перевірка: тест сюіт `Join` / рутина `routine1` / група тест кейсів `string` > тест кейс `trivial`. Відповідно, для позначення вкладення тест кейсів використовується знак `>`.

На основі проходження тест перевірок, утиліта робить висновок щодо проходження тестування в рутині: `Passed test routine ( Join / routine1 ) in 0,173s`.

Третя секція - підсумковий звіт по одному тест сюіту. При виконанні тестування скопом виводиться після завершення тестування окремого тест сюіта. В секції приводиться загальний підсумок - кількість пройдених перевірок, тест кейсів, тест рутин на основі чого робиться висновок про проходження тест сюіта.

В даному тест сюіті пройдено 5 тест перевірок, покладених в 5 тест кейсів, пройдено одну тест рутину. Висновок по тест сюіту `Join` - пройдений.

Четверта секція - загальний звіт по тестуванню. Звіт також включає кількість пройдених тест перевірок, тест кейсів, тест рутин та тест сюітів. При тестуванні скопом відповідна інформація сумується.

Директорія налічує лише один тест сюіт, тому загальний підсумок включає інформацію лише з попередньої секції.

### Звіт з помилкою

Звіт може містити провалені перевірки, які вказують на помилки коду програми, або помилки в коді тест сюіта.

<details>
    <summary><u>Код файла <code>Join.test.js</code> з помилкою в тесті</u></summary>

```js
let _ = require( 'wTesting' );
let Join = require( './Join.js' );

//

function routine1( test )
{
  test.open( 'string' );

    test.case = 'trivial';
    test.identical( Join.join( 'a', 'b' ), 'ab' );

    test.case = 'empty';
    test.identical( Join.join( '', '' ), '' );

  test.close( 'string' );
  test.open( 'number' );

    test.case = 'trivial';
    test.identical( Join.join( 1, 3 ), '13' );

    test.case = 'zeroes';
    test.identical( Join.join( 0, 0 ), '00' );

  test.close( 'number' );
  test.open( 'mixed' );

    test.will = 'str_num';
    test.identical( Join.join( 'a', 1 ), 'a2' );

  test.close( 'mixed' );
}

//

let Self =
{
  name : 'Join',
  tests :
  {
    routine1,
  }
}

//

Self = wTestSuite( Self );
if( typeof module !== 'undefined' && !module.parent )
wTester.test( Self.name );
```

</details>

Замініть вміст файла `Join.test.js` на приведений вище.

В файлі змінено тест кейс `mixed` - до нього додано рядок `test.will = 'str_num'`, котрий позначає назву перевірки. В перевірку було внесено помилку в очікуваному значенні - рутині `Join.join` передано значення `a` i `1`, а очікується `a2`.

Для отримання звіту тестування введіть команду `tst .imply v:5 .run Join.test.js`.

##### Звіт тестування при помилці в тест перевірці

![report2.png](../../images/report2.png)

Утиліта вивела розширену інформацію про помилку.

В звіті про помилку спочатку указано:
- отримане значення `got`;
- очікуване значення `expected`;
- різниця між отриманим і очікуваним значенням - `difference`.
З указаного виводу видно, що очікуване і отримане значення співпадають в літері `a`, а відрізняються в симолах, що йдуть слідом - `1` та `2`.

В наступній секції приводиться назва файла з помилкою, рядок в якому була провалена перевірка, а також, частина коду з проваленою тест перевіркою.

Підсумок по тест перевірці `Test check ( Join / routine1 / mixed < str_num # 5 ) ... failed`, містить  назву `str_num`, указану в коді тест сюіта. Назва тест перевірки та її номер відділені знаком `<`.

Результат проходження тест сюіту і загальний результат тестування вважаються проваленими через одну провалену перевірку.

### Підсумок

- Тест кейси можна групувати, це здійснюється вкладенням в форму `test.open()`, `test.close()` інших тест кейсів.
- Звіт по проходженню тест перевірок містить розташування перевірки, її назву і порядковий номер.
- Звіт по проваленим перевіркам може містити інформацію щодо різниці в очікуваному і отриманому значенні, частину коду тест сюіту з проваленою перевіркою.
- Для того, щоб результат тестування був 'пройдений' потрібно, щоб всі тести були пройдені успішно. Навіть через одну провалену тест перевірку результат тестування буде 'провалений'.
- Використовуючи інформацію про помилку розробник може відразу знайти частину коду, що була зламана.

[Повернутись до змісту](../README.md#tutorials)
